!function(a){a.Gesture=function(b){a.Listener.call(this),this.yccClass=a.Gesture,this.option=b,this._longTapTimeout=null,this._init()},a.Gesture.prototype=new a.Listener,a.Gesture.prototype._init=function(){a.utils.isMobile()?(console.log("mobile gesture init..."),this._initForMobile()):(console.log("pc gesture init..."),this._initForPC())},a.Gesture.prototype._initForMobile=function(){var b,c,d=this,e=new a.TouchLifeTracer({target:this.option.target}),f={tap:!1,swipe:!1};e.onlifestart=function(a){return d.triggerListener("tap",d._createEventData(a.startTouchEvent,"tap")),d.triggerListener("log","tap triggered"),e.currentLifeList.length>1?(d.triggerListener("log","multi touch start ..."),d.triggerListener("multistart",e.currentLifeList),f.tap=!1,f.swipe=!1,clearTimeout(this._longTapTimeout),b=e.currentLifeList[0],c=e.currentLifeList[1],this):(f.tap=!1,f.swipe=!1,d.triggerListener("dragstart",d._createEventData(a.startTouchEvent,"dragstart")),void(this._longTapTimeout=setTimeout(function(){d.triggerListener("longtap",d._createEventData(a.startTouchEvent,"longtap"))},750)))},e.onlifechange=function(g){if(e.currentLifeList.length>1){f.tap=!0,f.swipe=!0,d.triggerListener("log","multi touch move ..."),d.triggerListener("multichange",b,c);var h=d.getZoomRateAndRotateAngle(b,c);return a.utils.isNum(h.rate)&&(d.triggerListener("zoom",h.rate),d.triggerListener("log","zoom triggered",h.rate)),a.utils.isNum(h.angle)&&(d.triggerListener("rotate",h.angle),d.triggerListener("log","rotate triggered",h.angle)),this}if(g.moveTouchEventList.length>0){var i=g.startTouchEvent,j=Array.prototype.slice.call(g.moveTouchEventList,-1)[0];(Math.abs(j.pageX-i.pageX)>10||Math.abs(j.pageY-i.pageY)>10)&&(f.tap=!0,clearTimeout(this._longTapTimeout)),d.triggerListener("dragging",d._createEventData(j,"dragging"))}},e.onlifeend=function(a){if(1===e.currentLifeList.length)return d.triggerListener("multiend",b,c);if(0===e.currentLifeList.length){if(d.triggerListener("dragend",d._createEventData(a.endTouchEvent,"dragend")),!f.tap&&a.endTime-a.startTime<300)return clearTimeout(this._longTapTimeout),b&&a.endTime-b.endTime<300&&Math.abs(b.endTouchEvent.pageX-a.endTouchEvent.pageX)<10&&Math.abs(b.endTouchEvent.pageY-a.endTouchEvent.pageY)<10?(d.triggerListener("doubletap",d._createEventData(a.endTouchEvent,"doubletap")),d.triggerListener("log","doubletap triggered"),b=null,this):(b=a,this);if(!f.swipe&&a.endTime-a.startTime<300){console.log("swipe");var g=a.startTouchEvent,h=Array.prototype.slice.call(a.moveTouchEventList,-1)[0];if(Math.abs(h.pageX-g.pageX)>30||Math.abs(h.pageY-g.pageY)>30){var i="swipe"+d._getSwipeDirection(g.pageX,g.pageY,h.pageX,h.pageY);d.triggerListener("log",i),d.triggerListener(i,d._createEventData(a.endTouchEvent,i))}return this}}}},a.Gesture.prototype._initForPC=function(){var a=this,b=null,c=null,d=!1,e=null,f=-1;this.option.target.addEventListener("mousedown",function(c){b=a._createEventData(c),f=setTimeout(function(){console.log("longtap",Date.now(),"..."),a.triggerListener("log","long tap ..."),a.triggerListener("longtap",a._createEventData(b,"longtap"))},750)}),this.option.target.addEventListener("mousemove",function(e){if(b){if(b&&e.clientX===b.clientX&&e.clientY===b.clientY)return;if(c&&e.clientX===b.clientX&&e.clientY===b.clientY)return;clearTimeout(f),d||(a.triggerListener("dragstart",a._createEventData(b,"dragstart")),d=!0),a.triggerListener("dragging",a._createEventData(e,"dragging"))}else clearTimeout(f)}),this.option.target.addEventListener("mouseup",function(g){if(c=a._createEventData(g),d){if(clearTimeout(f),a.triggerListener("dragend",a._createEventData(g,"dragend")),d&&c.createTime-b.createTime<300&&(Math.abs(c.pageX-b.pageX)>30||Math.abs(c.pageY-b.pageY)>30)){var h="swipe"+a._getSwipeDirection(b.pageX,b.pageY,c.pageX,c.pageY);console.log("swipe",h),a.triggerListener("log",h),a.triggerListener(h,a._createEventData(b,h))}return d=!1,b=null,null}if(!d&&b&&c.createTime-b.createTime<300){clearTimeout(f);var i=a._createEventData(b,"tap");return a.triggerListener("tap",i),a.triggerListener("log","tap triggered"),e&&i.createTime-e.createTime<300&&Math.abs(e.pageX-i.pageX)<10&&Math.abs(e.pageY-i.pageY)<10?(a.triggerListener("doubletap",a._createEventData(i,"doubletap")),a.triggerListener("log","doubletap triggered"),preLife=null,this):(e=i,b=null,this)}})},a.Gesture.prototype._createEventData=function(b,c){var d={type:"",target:null,clientX:0,clientY:0,pageX:0,pageY:0,screenX:0,screenY:0,force:1,createTime:Date.now()};return d=a.utils.extend(d,b),d.type=c,d},a.Gesture.prototype._getSwipeDirection=function(a,b,c,d){return Math.abs(a-c)>=Math.abs(b-d)?a-c>0?"left":"right":b-d>0?"up":"down"},a.Gesture.prototype.getZoomRateAndRotateAngle=function(b,c){this.triggerListener("log","preLife"),this.triggerListener("log",b),this.triggerListener("log","curLife"),this.triggerListener("log",c);var d=b.startTouchEvent.pageX,e=b.startTouchEvent.pageY,f=c.startTouchEvent.pageX,g=c.startTouchEvent.pageY,h=b.moveTouchEventList.length>0?b.moveTouchEventList[b.moveTouchEventList.length-1]:b.startTouchEvent,i=c.moveTouchEventList.length>0?c.moveTouchEventList[c.moveTouchEventList.length-1]:c.startTouchEvent,j=h.pageX,k=h.pageY,l=i.pageX,m=i.pageY,n=new a.Math.Vector(f-d,g-e),o=new a.Math.Vector(l-j,m-k),p=Math.acos(o.dot(n)/(o.getLength()*n.getLength()))/Math.PI*180;return{rate:o.getLength()/n.getLength(),angle:p*(o.cross(n).z>0?-1:1)}}}(window.Ycc);
//# sourceMappingURL=Ycc.Gesture.class.min.js.map