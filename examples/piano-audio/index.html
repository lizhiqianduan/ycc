<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name=viewport content="width=device-width,initial-scale=1,user-scalable=0,viewport-fit=cover">
	<title>音频示例</title>
	<link rel="stylesheet" href="../style.css">
</head>
<body>
<div class="return-btn">
	<a href="../">
		返回首页
	</a>
</div>
<div class="tip">
	<h3>示例说明：</h3>
	<div>
		1、这个示例展示系统的音频播放功能。<br>
		2、点击播放，一首《那女孩对我说》送给你。<br>
	</div>
	<br><br>
</div>


<button onclick="play()" id="play" disabled>播放</button>
</body>
</html>

<script src="http://localhost:9000/livereload.js"></script>
<script src="../common.js"></script>
<script src="../../build/ycc.js"></script>

<script>

	var ycc = new Ycc();
	ycc.bindCanvas(ycc.createCanvas());


	var resArr = [
		'31!','32!','33!','34!','35!','36!','37!',
		'41!','42!','43!','44!','45!','46!','47!',
		'51!','52!','53!','54!','55!','56!','57!'
	].map(function(item){
		return {name:item,url:'./'+item+'.mp3',type:'audio'};
	});
	var map = {
		// 降调
		'1!':'41!',
		'2!':'42!',
		'3!':'43!',
		'4!':'44!',
		'5!':'45!',
		'6!':'46!',
		'7!':'47!',
		// 正常
		'1#':'31!',
		'2#':'32!',
		'3#':'33!',
		'4#':'34!',
		'5#':'35!',
		'6#':'36!',
		'7#':'37!',

		// 升调
		'1b':'51!',
		'2b':'52!',
		'3b':'53!',
		'4b':'54!',
		'5b':'55!',
		'6b':'56!',
		'7b':'57!',
	};
	var song = [];
	// 那女孩对我说 500ms
	song = [
		'5! 6! 1# 1# 6! 2# 00',
		'2# 7! 2# 3# 3# 7! 1# 00',
		'1# 7! 5! 6! 6! 00',
		'6! 5! 6! 3! 3! 2! 3! 00',
		'5! 6! 1# 4# 3# 2# 00',
		'2# 7! 2# 3# 3# 7! 1# 00',
		'1# 7! 3# 3# 7! 6! 00',
		'6! 7! 1# 5# 3# 4# 3# 00',
		//
		'5! 6! 1# 1# 6! 2# 00',
		'2# 7! 2# 3# 3# 7! 1# 00',
		'1# 7! 5! 6! 6! 00',
		'6! 5! 6! 3! 3! 2! 3! 00',
		'5! 6! 1# 4# 3# 2# 00',
		'2# 7! 2# 3# 3# 7! 1# 00',
		'1# 7! 3# 3# 7! 6! 00',
		'6! 1# 3# 4# 2# 7! 1# 00'
	];

	// 缘分一道桥 300ms
	song = [
		'5! 6! 1# 00',
		'6! 1# 2# 00 1# 00',
		'3b 5b 6b 5b 3b 00',
		'6# 5# 3# 00',
		'5# 3# 2# 1# 1# 3# 2# 00 00',

		'5! 6! 1# 00',
		'6! 1# 2# 00 1# 00',
		'3b 5b 6b 7b 7b 00',
		'6# 5# 3# 00',
		'5# 3# 2# 1# 1# 2# 3# 3# 2# 2# 1# 00 00',

		'5! 6! 1# 00',
		'6! 1# 2# 00 1# 00',
		'3b 5b 6b 5b 3b 00',
		'6# 5# 3# 00',
		'5# 3# 2# 1# 1# 3# 2# 00 00',

		'5! 6! 1# 00',
		'6! 1# 2# 00 1# 00',
		'3b 5b 6b 7b 7b 00',
		'6# 5# 3# 00',
		'5# 3# 2# 1# 1# 2# 3# 00 3# 00 2# 00 2# 00 1# 00 00',
	];

	// 把孤独当做晚餐 300ms
	song = [
		'3# 3# 2# 2# 1# 1# 00 6! 6! 2# 3# 5# 3# 00',
		'3# 3# 2# 2# 1# 1# 00 6! 6! 2# 3# 7# 5# 00',
		'3# 3# 2# 2# 1# 1# 00 6! 2# 00 2# 3# 5# 7# 1! 00',
		'3# 2# 6! 00 3# 00 2# 3# 5! 6! 00',

		// '2! 3! 4! 5! 6! 7!',
		// '1# 2# 3# 4# 5# 6# 7#',
		// '1b 2b 3b 4b 5b 6b 7b 1!',
	];

	// 断了的弦 300ms
	song = [
			// '5# 4# 00 3# 3# 00 00 5# 4# 00 3# 3# 00 00',
			// '2# 3# 00 5# 1! 00 00 1! 7# 00 6# 6# 00 5# 00',
			// '5# 1# 00 2# 3# 00 00 5# 3# 1# 2# 1#',
			// '1# 7! 1# 4# 3# 3# 2# 2# 00 1# 4# 4# 3# 3# 2# 1# 00 6! 1# 00',
		'6! 7# 7# 7# 7# 6# 6# 00',
		'7# 7# 7# 7# 7# 1! 6# 00',
		'6# 6# 6# 5# 5# 2# 3# 00',
		'5# 5# 5# 3# 3# 1# 2# 00',
		//
		'6! 7# 7# 7# 7# 6# 6# 00',
		'7# 7# 7# 7# 7# 1! 6# 00',
		'6# 6# 6# 5# 5# 2# 3# 5# 00',

			// '1# 00 7! 1# 00 00 1# 3# 2# 00 6! 1# 00 00',
			// '6! 1# 00 4# 3# 00 2# 1# 4# 4#'
	];

	// 小毛驴
	song = [
			'11135555666'.split('').map(item=>item+'#').join(' '),
		'1b',
		'5044463333222250511135555666'.split('').map(item=>item+'#').join(' '),
		'1b',
		'50444633333322231'.split('').map(item=>item+'#').join(' ')
	];



	ycc.loader.loadResOneByOne(resArr,function(resArr){
		onLoad();
	});


	function onLoad(){
		document.getElementById('play').disabled=false;
	}

	function play(){
		var index = 0;
		setInterval(function(){
			var resName = map[song.join(' ').split(' ')[index]];
			var tone = ycc.loader.getResByName(resName,resArr);
			if(tone) tone.res.play();
			index++;
		},300);
	}





</script>